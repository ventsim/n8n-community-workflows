graph TD
    A[üîÑ Manual Trigger] --> B[üë• Fetch WooCommerce Customers]
    B --> C[üìä Process Customer Data]
    C --> D{‚ùì Customer Eligible?<br/>lifetime_total > 90}
    D -->|‚úÖ Yes| E[üë§ Create/Update HubSpot Contact]
    D -->|‚ùå No| F[‚è≠Ô∏è Skip Contact Creation]
    E --> G[üì¶ Fetch Customer Orders]
    F --> G
    G --> H[üîÑ Process Orders]
    H --> I{‚ùì Order Exists in HubSpot?}
    I -->|‚ùå No| J[üíº Create HubSpot Order]
    I -->|‚úÖ Yes| K[‚è≠Ô∏è Skip Order Creation]
    J --> L[üìã Extract Line Items]
    L --> M[üîç Find Matching HubSpot Products]
    M --> N[üì¶ Create HubSpot Line Items]
    K --> H
    
    classDef darkNode fill:#2d3748,stroke:#4a5568,color:#ffffff,stroke-width:2px
    class A,B,C,D,E,F,G,H,I,J,K,L,M,N darkNode
    linkStyle default stroke:#ffffff,stroke-width:2px