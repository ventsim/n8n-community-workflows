flowchart TD
    A[Schedule Trigger] --> B[Get Company Folders]
    B --> C[Get Month Folders]
    C --> D{Filter Current Month?}
    D -- Yes --> E[Find/Create Spreadsheet]
    D -- No --> F[End for Month]
    E --> G[Get Files]
    G --> H{Filter File Types?}
    H -- Images/PDFs --> I[Switch MIME Type]
    H -- Other --> J[Skip File]
    I -- Image --> K[Process via OCR.SPACE]
    I -- PDF --> L[Extract Text from PDF]
    K --> M[Merge Processed Data]
    L --> M
    M --> N[AI Information Extraction]
    N --> O[Store in Google Sheets]
    O --> P[End]
    
    style A fill:#ff6b6b
    style D fill:#feca57
    style H fill:#feca57
    style I fill:#feca57
    style O fill:#48dbfb
    style B fill:#1dd1a1
    style C fill:#1dd1a1
    style E fill:#54a0ff
    style G fill:#54a0ff
    style K fill:#ff9ff3
    style L fill:#ff9ff3
    style M fill:#f368e0
    style N fill:#00d2d3