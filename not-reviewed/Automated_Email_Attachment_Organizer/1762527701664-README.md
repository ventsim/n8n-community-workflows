## **Whoâ€™s it for**

This workflow is designed for professionals and teams who receive regular email attachments from specific senders and need automated organization. Ideal for finance teams processing invoices, HR departments handling resumes, legal teams managing contracts, or any business that receives structured document submissions via email and requires consistent digital filing.

## **How it works**

The workflow automatically monitors Gmail for new emails with a specific label, verifies sender authorization against a Google Sheets whitelist, creates organized folder structures in Google Drive by company and date, then uploads all attachments with timestamp prefixes. It processes multiple attachments per email and maintains folder hierarchy automatically. The system ensures only approved senders can trigger the workflow and organizes files in a logical company/year/month structure for easy retrieval.

## **Requirements**

Required credentials: Gmail OAuth2 API access, Google Drive OAuth2 API access, Google Sheets OAuth2 API access. Required accounts: Active Gmail account with emails to process, Google Drive account with sufficient storage space, Google Sheets account for maintaining the sender whitelist. Required configuration: Gmail label 'Label_2' for filtering incoming emails, Google Sheets document with email-to-company mapping, designated parent folder in Google Drive for organized storage.

## **How to set up**

1. Configure Gmail OAuth2 credentials in n8n and create a label called 'Label_2' for filtering emails
2. Set up Google Drive OAuth2 credentials and identify your target parent folder for storage
3. Create a Google Sheets document with two columns: sender email addresses and corresponding company names
4. Configure Google Sheets OAuth2 credentials and connect to your whitelist document
5. Update the Gmail trigger node to poll every 15 minutes and filter for 'Label_2'
6. Modify the folder naming logic in the 'YYYY/MM' node if you prefer different date formatting
7. Test the workflow by sending an email with attachments to a whitelisted address with the specified label

## **How to customize the workflow**

You can customize the folder structure by modifying the date format in the 'YYYY/MM' node to use different time formats. Adjust the polling frequency in the Gmail trigger from 15 minutes to your preferred interval. Extend the whitelist functionality by adding additional validation criteria in the Google Sheets lookup. Modify the file naming convention in the upload node to include different metadata prefixes. Add additional processing steps after file upload such as notification emails, data extraction, or integration with other business systems.