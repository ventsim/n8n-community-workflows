# Automated Email Attachment Organizer
## Purpose
ğŸ¯ This workflow solves the common business problem of disorganized email attachments by providing automated, structured storage in Google Drive. It eliminates manual file sorting, reduces human error in file organization, and ensures consistent naming conventions across all stored documents. The system maintains a clear audit trail of incoming documents while providing quick access through logical folder hierarchies.
## Target audience
ğŸ‘¥ Primary users include administrative professionals managing client documentation, sales teams processing customer documents, accounting departments handling invoices and financial records, project managers organizing project deliverables, and legal teams managing contract submissions. Secondary users include IT administrators implementing document management solutions and business process automation specialists.
## Overview
ğŸ—ï¸ The workflow operates on a three-tier organizational structure: company-level folders containing year/month subfolders with timestamped individual files. It implements a whitelist security model to prevent unauthorized file processing, uses conditional folder creation to handle new companies and time periods automatically, and processes multiple attachments through batch operations for efficiency. The system maintains data integrity through consistent naming conventions and structured storage paths.

```mermaid
  flowchart TD
    A[ğŸ“¥ Gmail Trigger<br/>Monitor Label_2 Emails] --> B[ğŸ“‹ Whitelist Validation<br/>Check Sender Against Google Sheets]
    B --> C{â“ Company Folder Exists?}
    C -->|No| D[ğŸ“ Create Company Folder<br/>Google Drive]
    C -->|Yes| E[ğŸ“… Format Year/Month<br/>From Email Date]
    D --> E
    E --> F{â“ Year/Month Folder Exists?}
    F -->|No| G[ğŸ“‚ Create Year/Month Folder<br/>Google Drive]
    F -->|Yes| H[ğŸ“§ Retrieve Full Email<br/>With Attachments]
    G --> H
    H --> I[ğŸ”§ Split Binary Data<br/>Separate Attachments]
    I --> J[ğŸ”„ Process Attachments<br/>Batch Loop]
    J --> K[ğŸ“¤ Upload Files<br/>With Timestamp Prefix]
    
    style A fill:#4285F4,color:white
    style B fill:#34A853,color:white
    style C fill:#FBBC05,color:black
    style D fill:#EA4335,color:white
    style E fill:#4285F4,color:white
    style F fill:#FBBC05,color:black
    style G fill:#EA4335,color:white
    style H fill:#4285F4,color:white
    style I fill:#34A853,color:white
    style J fill:#FBBC05,color:black
    style K fill:#EA4335,color:white
```
# How-to Guide
## Step by step
ğŸ“ Implementation guide:
1. Prepare your Google Sheets whitelist with two columns: sender email addresses and corresponding company names
2. Create a dedicated Google Drive folder that will serve as the parent directory for all company folders
3. In Gmail, create or identify the label (Label_2) that will trigger the automation
4. Configure the Gmail Trigger node with your OAuth2 credentials and set the polling interval to 15 minutes
5. Update the Google Sheets node with your whitelist spreadsheet ID and range
6. Modify all Google Drive nodes to reference your parent folder ID
7. Test the workflow by sending an email with attachments to a whitelisted sender address
8. Verify that folders are created correctly and files are uploaded with proper naming
## Conditional Paths
ğŸ”„ Workflow decision points:
â€¢ If sender email is not in whitelist â†’ Workflow stops processing
â€¢ If company folder does not exist â†’ System creates new company folder
â€¢ If year/month folder does not exist â†’ System creates new date folder
â€¢ If email has multiple attachments â†’ Each attachment processes individually
â€¢ If folder creation fails â†’ Subsequent steps will not execute
â€¢ If file upload fails â†’ Error is logged but other attachments continue processing
## Success Criteria
âœ… Verification checklist:
â€¢ Emails with Label_2 trigger workflow execution
â€¢ Whitelisted senders process successfully
â€¢ New company folders create automatically when needed
â€¢ Year/month subfolders generate with correct formatting
â€¢ All attachments upload to appropriate folders
â€¢ Files receive timestamp prefixes in filenames
â€¢ No duplicate files from the same email
â€¢ Error-free execution for valid emails

# Reference
## Technical Specifications
âš™ï¸ System configuration details:
â€¢ Polling interval: 15 minutes (configurable)
â€¢ Batch size: Default n8n settings (configurable)
â€¢ File naming: Timestamp + original filename
â€¢ Folder structure: Company/YYYY/MM/
â€¢ Supported file types: All Gmail attachment types
â€¢ Maximum file size: Google Drive upload limits apply
â€¢ Authentication: OAuth2 for all Google services
â€¢ Error handling: Conditional folder creation, batch processing
## Input/Output
ğŸ“Š Data flow specifications:

| Attribute | Data Type | Description |
|-----------|-----------|-------------|
| Email Subject | String | Original email subject line |
| Sender Email | String | From address for validation |
| Attachment Count | Number | Number of files in email |
| Email Date | Date/Time | Received timestamp for folder creation |
| Company Name | String | Derived from whitelist lookup |
| Attachment Data | Binary | File content for upload |

| Output Attribute | Data Type | Description |
|------------------|-----------|-------------|
| Uploaded File URL | String | Google Drive file link |
| Folder Path | String | Created directory structure |
| Processing Status | String | Success/failure indicator |
| File Metadata | Object | Size, type, and timestamp information |
| Error Messages | String | Any processing failures encountered |
## Dependencies
ğŸ”— External requirements:
â€¢ Google Workspace account with Gmail, Drive, and Sheets access
â€¢ OAuth2 credentials configured for all three Google services
â€¢ Pre-existing Google Sheets document with whitelist data
â€¢ Parent Google Drive folder with write permissions
â€¢ Network connectivity to Google APIs
â€¢ n8n instance with sufficient storage for temporary file processing

# Tutorial
## Learning Path
ğŸ“ Progressive learning approach:
1. Start with basic setup: Configure one service at a time (Gmail â†’ Sheets â†’ Drive)
2. Test individual components: Verify trigger works, then whitelist lookup, then folder operations
3. Understand error scenarios: Test with non-whitelisted senders and missing folders
4. Explore customization: Modify folder naming and file processing logic
5. Scale the solution: Add multiple users and increase volume gradually
6. Implement monitoring: Set up alerts and logging for production use

## Practice Exercises
ğŸ‹ï¸ Hands-on activities:
â€¢ Create a test whitelist with 5 sample companies and emails
â€¢ Send test emails with different attachment types (PDF, images, documents)
â€¢ Modify the folder naming convention to include project codes
â€¢ Add a notification step that sends confirmation emails
â€¢ Create a backup workflow that processes a different Gmail label
â€¢ Implement file type filtering to only process specific document formats
â€¢ Add metadata extraction for uploaded files
â€¢ Create a reporting node that tracks monthly upload statistics